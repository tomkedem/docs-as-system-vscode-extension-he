<div dir="rtl" style="text-align: right;">

> ⚙️ **הודעת תבנית:**  
> קובץ זה הוא תבנית רשמית של Docs-as-System.  
> אין לערוך אותו ישירות בתוך הפרויקט — בעת אתחול מערכת חדשה, יש להעתיק אותו אל תיקייה בשם `docs/`  
> ולשמור את הקובץ בשם `AGENT_OPERATIONAL_POLICY.md` ולהתאים לארגון.

# תבנית מדיניות פעולה לסוכן

**מסמך בפרויקט בפועל:** `docs/agent/AGENT_OPERATIONAL_POLICY.md`  
**תבנית בתיקיית התבניות:** `templates/agent/AGENT_OPERATIONAL_POLICY_TEMPLATE.md`  
**קובץ תצורה נלווה:** `docs/agent/AGENT_CONFIG.yaml`  
**יוצר:** אדם בהתאם למדיניות הארגון  
**מאשר:** ארכיטקט ראשי / מנהל אבטחה / Tech Lead  
**סוג מסמך:** מדיניות פעולה  

**מטרה**  
להגדיר את אופן הפעולה, הבקרה, האבטחה והתיעוד של סוכן ה־AI הפועל בפרויקט.  
המדיניות מבטיחה שכל פעולה של הסוכן ניתנת למעקב, נבדקת אנושית, ומתועדת באופן מלא.

---

## עקרונות יסוד

1. הסוכן פועל רק לפי מסמכים מאושרים בפרויקט: `PROJECT_SPEC.md`, `ARCHITECTURE_BLUEPRINT.md`, `PLAN.md`.  
   בתיקיית התבניות הם קיימים כ־`*_TEMPLATE.md`.  
2. כל שינוי של הסוכן נרשם ביומן המימוש `docs/logs/IMPLEMENTATION_LOG.md`.  
3. הסוכן אינו כותב לענפים מוגנים כמו `main` או `release/*`. הוא פועל רק בענפים ייעודיים מסוג `agent/*`.  
4. כל תוצר עובר Review ואישור אנושי לפני מיזוג.  
5. במקרה של סתירה בין מסמכים או אי־ודאות, הסוכן עוצר ודורש הנחיה מפורשת.  

---

## מדיניות עבודה יומית

| תחום | עקרונות |
|------|----------|
| כתיבת קוד | מבוסס הגדרות, שמות עקביים, קוד קריא בלבד. |
| תיעוד | כל שינוי בקוד מחייב עדכון במסמך הרלוונטי. |
| Git | קומיטים קטנים עם כותרת ברורה ותיאור הכולל הפניה למסמך מקור. |
| בדיקות | Self-Check לפני כל Commit ו־Pull Request. |
| שגיאות | מתועדות ביומן, מסומנות בסטטוס, והפעולה נעצרת עד להנחיה אנושית. |

---

### עקרונות פעולה

- **אין שימוש במפתחות, סיסמאות או אסימוני גישה (Tokens) בקוד גלוי.**  
  יש להשתמש במשתני סביבה או בקובצי קונפיגורציה מאובטחים בלבד.

- **ולידציה לקלטים (Input Validation):**  
  בכל קוד שיוצר או מתוקן על־ידי הסוכן נדרשת בדיקה שהקלט עובר ולידציה בסיסית לפני עיבוד.

- **הימנעות מהזרקות (Injection Safety):**  
  כל גישה למסד נתונים או להרצת פקודות משתמשת בפרמטרים ולא במחרוזות דינמיות.

- **שמירה על Least Privilege:**  
  הקוד שנוצר לא מניח הרשאות מנהל אלא גישה מינימלית בלבד לפעולה הדרושה.

- **שמירה על פרטיות מידע:**  
  אין לכתוב ללוגים או למסמכים מידע מזהה אישי, סיסמאות או טוקנים.  
  אם יש צורך בבדיקת נתונים רגישים — יש לחתוך או להצפין אותם.

- **תיעוד אבטחתי:**  
  כל שינוי שקשור לאבטחה מתועד ב־`docs/logs/IMPLEMENTATION_LOG.md` עם התג `SECURITY_CHANGE`.

- **בדיקות Self-Security:**  
  לפני כל Commit הסוכן בודק שאין קריאות בלתי מבוקרות, כתיבה ישירה לקבצים חיצוניים, או שדות רגישים בקוד.

---

## אבטחה ו־Secure Coding

- ולידציה לקלטים ו־Output Encoding לפי הקונטקסט (Web, CLI, DB).  
- עבודה עם הרשאות מינימליות בלבד (Least Privilege).  
- כל סוד מאוחסן ב־Secret Store או במשתני סביבה בלבד.  
- לוגים נקיים ממידע רגיש. במקרה הצורך — מסווה או חותך ערכים.  
- כל קוד חדש נבדק מול ספריות מוכרות למניעת שימוש בתלויות פגיעות.  
- הרצת סורקי תלויות ויצירת SBOM כחלק מבדיקות ה־Self Validation.  
- כל חריגה באבטחה נרשמת ביומן עם תיעוד תמציתי של הסיבה והפתרון.  

---

## מבנה קומיט מומלץ

כותרת קצרה, תיאור ממוקד, והפניה למסמך מקור או משימה.

```
feat(billing): add idempotency check in BillingConsumer

Refs: docs/PROJECT_SPEC.md §3.4, docs/PLAN.md #Task-12
AI-Generated: true
Human-Approved: true
Validated: true

```

---

## מדיניות תיעוד

- כל שינוי נרשם ביומן `docs/logs/IMPLEMENTATION_LOG.md` עם תאריך, מזהה קומיט ותיאור קצר.  
- עדכון מסמך קיים חייב לשמור מבנה עקבי של כותרות וקישורים.  
- קובץ חדש נוצר עם הערת מקור:  
  `"נוצר על־ידי סוכן AI לפי הנחיות אדם בתאריך …"`.  

---

## Self-Validation לפני קומיט או PR

לפני כל Commit או Pull Request הסוכן מריץ:

1. קומפילציה או Lint של הקוד.  
2. Unit Tests רלוונטיים.  
3. Markdown Lint למסמכים ששונו.  
4. Link Checker לכל הקישורים במסמכים.  
5. בדיקת עקביות בין קוד למסמכים (`Spec`, `Blueprint`).  
6. בדיקת נוכחות Git Trailers בקומיט.  
7. בדיקות אבטחה: שאין סודות, שהתלויות עברו סריקה, ושאין קריאות מסוכנות.  

אם אחת הבדיקות נכשלת — רושמים ביומן ומסמנים `VALIDATION_FAILED`,  
בלי לדחוף קוד הלאה.

---

## טיפול בחריגות

- במקרה של שגיאה בקוד, ב־Git או בהנחיה — הסוכן מסמן `PENDING_REVIEW` ומוסיף הסבר ביומן.  
- במקרים חוזרים — מפיק דוח Self-Diagnosis עם שורש הבעיה.  
- ממשיך לפעולה רק לאחר אישור אנושי.  

---

## עקביות בין מסמכים

| קשר | מה בודקים |
|------|------------|
| Business → Project Spec | שהדרישה העסקית משתקפת ב־Spec. |
| Project Spec → Blueprint | שהארכיטקטורה מיישמת את הסעיפים. |
| Blueprint → Implementation Log | שכל שינוי בקוד מתועד לפי התכנון. |
| Compliance / Agent Policy | שהמדיניות תואמת למסמכים האחרים. |

---

## אינטגרציה עם BY_CYCLE בלוגים

- כל פעולה של הסוכן נרשמת ב־`docs/logs/IMPLEMENTATION_LOG.md`.  
- בסוף כל מחזור עבודה מופק סיכום לפי  
  `templates/logs/IMPLEMENTATION_LOG_SUMMARY_BY_CYCLE_TEMPLATE.he.md`.  
- בכל רשומה חובה לציין:  
  - `CycleId`  
  - `When`  
  - `Actor` (Agent/Human)  
  - `Scope` (קבצים או מודולים)  
  - `SpecRef`  
  - `Result` (Success/Failed/Pending)  
  - `SecurityChange` (Yes/No)  
  - `PR`  

---

## זרימת עבודה טיפוסית

1. אדם מאשר סעיף חדש ב־`docs/project/PROJECT_SPEC.md`.  
2. הסוכן יוצר קוד, מעדכן את ה־Blueprint, ופותח ענף `agent/...`.  
3. הסוכן מוסיף רשומה ביומן הפעילות.  
4. אדם מבצע Review וממזג ל־`feature/*` או יוזם PR ל־`main`.  
5. לאחר בדיקות מוצלחות מסמנים כ־`Validated`.  

---

## סיכום

המדיניות מגדירה את גבולות האחריות בין אדם לסוכן.  
היא מבטיחה תהליך מתועד, נשלט, מאובטח וניתן למעקב.  
כך נשמר האיזון בין יעילות אוטומטית לפיקוח אנושי אמיתי.

---

>© 2025 תומר קדם. חלק ממערך התבניות הרשמי של **Docs-as-System**.

</div>
