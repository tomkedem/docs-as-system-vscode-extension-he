<div dir="rtl" style="text-align: right;">

> ⚙️ **הערת תבנית:**  
> קובץ זה הוא תבנית רשמית של **Docs-as-System**.  
> אין לערוך אותו ישירות בתוך המאגר הראשי.  
> בעת הקמת פרויקט חדש, הסוכן מעתיק אותו אל התיקייה `docs/automation/`  
> בשם `GUARDRAILS.md` ומתאים אותו למדיניות הספציפית של אותו פרויקט.

# 🧩 תבנית Guardrails — כללי בקרה לסוכן

**מסמך בפרויקט בפועל:** `docs/automation/GUARDRAILS.md`  
**תבנית בתיקיית התבניות:** `templates/automation/GUARDRAILS_TEMPLATE.md`  
**יוצר:** סוכן (בהנחיית אדם)  
**מאשר:** ארכיטקט / מנהל אבטחת מידע / Tech Lead  
**מטרה:** להגדיר את הגבולות והבקרות שבתוכן הסוכן רשאי לפעול.

---

## 🎯 מטרת המסמך

להבטיח שכל פעולה של סוכן AI במסגרת Docs-as-System  
תתבצע תחת תנאים בטוחים, ניתנים למעקב ולשחזור מלא.  

המסמך מגדיר את **ה־Guardrails** —  
מערכת הכללים, הבלמים והבקרות שמונעות מהסוכן לחרוג מתחום אחריותו  
או לפגוע בשלמות המערכת, הקוד או הנתונים.

---

## 🧠 עקרונות פעולה

1. **שקיפות מוחלטת:** כל פעולה של הסוכן נרשמת ביומן (`IMPLEMENTATION_LOG.md`).  
2. **No Auto-Merge:** הסוכן לעולם לא ממזג שינויים לענף מוגן.  
3. **Human Gate:** כל שינוי מהותי עובר דרך אישור אנושי.  
4. **Self-Validation:** לפני כל פעולה, הסוכן בודק אם היא עומדת בכלליו הפנימיים.  
5. **Context-Limited:** הסוכן פועל רק בתחומי הקבצים או התיקיות שאושרו בקובץ התצורה (`AGENT_CONFIG.yaml`).  
6. **Immutable History:** אין מחיקה או שינוי של תיעוד היסטורי.  
7. **Reversible Actions:** כל שינוי חייב להיות ניתן לביטול מלא (Rollback).  

---

## 🧩 מבנה הבקרות

| סוג בקרה | תיאור | מופעל על ידי | תג פעולה בלוג |
|------------|----------|----------------|----------------|
| **Validation Guard** | בדיקת עקביות בין תיעוד לקוד | סוכן | `SELF_CHECK` |
| **Security Guard** | זיהוי מפתחות, טוקנים או מידע רגיש | סוכן + אדם | `SECURITY_ALERT` |
| **Scope Guard** | מניעת גישה לתיקיות מחוץ לאזור המורשה | סוכן | `ACCESS_DENIED` |
| **Schema Guard** | בדיקת שלמות מבנה מסמכים (Markdown/YAML) | סוכן | `DOC_VALIDATION` |
| **Log Guard** | אימות שכל פעולה מתועדת ב־Log | סוכן | `LOG_CHECK` |
| **Approval Guard** | עצירה אוטומטית עד לאישור אנושי | אדם | `HUMAN_REQUIRED` |

---

## 🧾 תהליך עבודה תקין (Flow)

1. **הסוכן מקבל משימה** מתוך אחד ממסמכי התכנון (`PLAN`, `SPEC`, `ADR`).  
2. **בדיקה עצמית (Pre-Check):** הסוכן בודק אם הפעולה מותרת ומגובה בתיעוד.  
3. **ביצוע בפועל (Action):** הסוכן מבצע רק את מה שאושר ומעדכן בלוג.  
4. **ולידציה (Post-Check):** נבדק שהתוצאה עומדת בכללי התאימות והאבטחה.  
5. **הסקת תובנות (Learning):** הסוכן מתעד במערכת את התוצאות, כולל חריגות.  
6. **אישור אנושי:** נדרש אישור סופי לכל פעולה בקטגוריה “sensitive”.

---

## ⚙️ טיפול בחריגות

| סוג חריגה | תג פעולה | תיאור | נדרש אישור אנושי |
|-------------|-------------|---------|--------------------|
| **CODE_MOD_OUTSIDE_SCOPE** | 🚫 | ניסיון לשינוי קובץ מחוץ לתחום ההרשאה | ✅ |
| **SECURITY_VIOLATION** | 🛑 | זיהוי נתון רגיש (Token / Password / Key) | ✅ |
| **MISSING_LOG_ENTRY** | ⚠️ | פעולה שבוצעה ללא תיעוד בלוג | ✅ |
| **CONFIG_CONFLICT** | ⚙️ | קונפליקט בין קובצי הגדרה | ✅ |
| **VALIDATION_FAILED** | ❗ | מבנה מסמך לא תקין או נתון חסר | ❌ (Auto Fix) |

> כל חריגה נרשמת אוטומטית ב־`IMPLEMENTATION_LOG.md`  
> תחת תגית `EXCEPTION`, ונסקרת בסוף כל מחזור עבודה (`BY_CYCLE`).

---

## 🔁 אינטגרציה עם BY_CYCLE

- כל מחזור עבודה (`Cycle`) כולל הפעלה מלאה של מנגנון ה־Guardrails.  
- בסוף המחזור מופק דו"ח סיכום בשם `GUARDRAILS_REPORT_BY_CYCLE.md`.  
- הסוכן מבצע Self-Diagnosis ומסמן חריגות שנדרשות לבדיקה אנושית.  
- רק לאחר אישור אנושי נוצר תקציר סופי (`IMPLEMENTATION_LOG_SUMMARY_BY_CYCLE.md`).

---

## 🧩 עקרונות ניטור ובקרה

- כל בקרה רצה אוטומטית עם תחילת פעולה של הסוכן.  
- כל שינוי בתצורת Guardrails מחייב Commit נפרד ותיעוד מלא.  
- הסוכן לא רשאי להשבית בקרה פעילה ללא אישור מנהל.  
- ניתן להרחיב את ה־Guardrails באמצעות סקריפטים מותאמים בתיקייה `automation/scripts/`.

---

## 📄 קשר למסמכים נוספים

| מסמך | תפקיד בהקשר |
|--------|--------------|
| `AGENT_OPERATIONAL_POLICY.md` | מגדיר את אופן פעולת הסוכן בפועל. |
| `HUMAN_OPERATIONAL_POLICY.md` | מתאר את אחריות הבקרה האנושית. |
| `COMPLIANCE_AND_GOVERNANCE.md` | מספק את המסגרת המשפטית והארגונית. |
| `IMPLEMENTATION_LOG.md` | מתעד כל פעולה וחריגה בזמן אמת. |
| `VALIDATION_REPORT.md` | מסכם את תוצאות הבדיקות האוטומטיות. |

---

## 🧭 סיכום

`GUARDRAILS.md` הוא **קו ההגנה הראשון של המערכת**.  
הוא מוודא שכל פעולה — של סוכן או אדם —  
מתבצעת תחת גבולות ברורים, בתיעוד מלא,  
ובשקיפות מוחלטת הניתנת לביקורת בכל רגע.

> הסוכן אינו מחליף בקרה אנושית — הוא רק מיישם אותה בקצב של מכונה.  

---

>© 2025 תומר קדם. חלק ממערך התבניות הרשמי של **Docs-as-System**.

</div>
